<!-- order-history.component.html - Invoice Style -->
<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="fas fa-receipt me-2"></i>Order History</h2>
        <button class="btn btn-outline-primary" (click)="retry()">
          <i class="fas fa-sync-alt"></i> Refresh
        </button>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading" class="text-center py-5">
        <div class="spinner-border" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3">Loading your orders...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !loading" class="alert alert-danger" role="alert">
        <h5 class="alert-heading">Error Loading Orders</h5>
        <p>{{ error }}</p>
        <hr>
        <button class="btn btn-outline-danger btn-sm" (click)="retry()">
          Try Again
        </button>
      </div>

      <!-- Empty State -->
      <div *ngIf="!loading && !error && orders.length === 0" class="text-center py-5">
        <i class="fas fa-shopping-bag fa-3x text-muted mb-3"></i>
        <h4 class="text-muted">No Orders Found</h4>
        <p class="text-muted">You haven't placed any orders yet.</p>
        <a routerLink="/books" class="btn btn-primary">
          <i class="fas fa-book"></i> Browse Books
        </a>
      </div>

      <!-- Orders List - Invoice Style -->
      <div *ngIf="!loading && !error && orders.length > 0">
        <div class="row">
          <div class="col-12" *ngFor="let order of orders">
            <div class="card mb-4 shadow-sm invoice-card">
              <!-- Invoice Header -->
              <div class="card-header bg-primary text-white">
                <div class="row align-items-center">
                  <div class="col-md-6">
                    <h5 class="mb-1"><i class="fas fa-file-invoice me-2"></i>Invoice #{{ order.id }}</h5>
                    <small>Order Date: {{ order.orderDate | date:'fullDate' }}</small>
                  </div>
                  <div class="col-md-6 text-md-end">
                    <span class="badge fs-6 px-3 py-2" [ngClass]="getStatusClass(order.status)">
                      <i class="fas fa-circle me-1" style="font-size: 0.6em;"></i>
                      {{ order.status }}
                    </span>
                  </div>
                </div>
              </div>

              <div class="card-body">
                <!-- Invoice Details -->
                <div class="row mb-4">
                  <div class="col-md-6">
                    <h6 class="text-primary mb-2">Billing Information</h6>
                    <div class="border-start border-primary border-3 ps-3">
                      <p class="mb-1"><strong>Order ID:</strong> #{{ order.id }}</p>
                      <p class="mb-1"><strong>Date:</strong> {{ order.orderDate | date:'medium' }}</p>
                      <p class="mb-0"><strong>Status:</strong> 
                        <span class="badge ms-1" [ngClass]="getStatusClass(order.status)">{{ order.status }}</span>
                      </p>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <h6 class="text-primary mb-2">Shipping Address</h6>
                    <div class="border-start border-success border-3 ps-3">
                      <p class="mb-0 text-muted">{{ order.address }}</p>
                    </div>
                  </div>
                </div>

                <!-- Invoice Items Table -->
                <div class="table-responsive mb-4">
                  <table class="table table-bordered">
                    <thead class="table-light">
                      <tr>
                        <th scope="col" style="width: 50%">Item Description</th>
                        <th scope="col" class="text-center" style="width: 15%">Qty</th>
                        <th scope="col" class="text-end" style="width: 17.5%">Unit Price</th>
                        <th scope="col" class="text-end" style="width: 17.5%">Total</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of order.orderItems">
                        <td>
                          <div class="d-flex align-items-center">
                            <div class="me-3">
                              <i class="fas fa-book text-primary fa-lg"></i>
                            </div>
                            <div>
                              <div class="fw-bold">{{ item.book.title }}</div>
                              <small class="text-muted">by {{ item.book.author }}</small><br>
                              <small class="text-muted">Category: {{ item.book.category }}</small>
                            </div>
                          </div>
                        </td>
                        <td class="text-center align-middle">
                          <span class="badge bg-light text-dark">{{ item.quantity }}</span>
                        </td>
                        <td class="text-end align-middle">
                          <strong>${{ item.price | number:'1.2-2' }}</strong>
                        </td>
                        <td class="text-end align-middle">
                          <strong class="text-primary">${{ (item.price * item.quantity) | number:'1.2-2' }}</strong>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <!-- Invoice Summary -->
                <div class="row justify-content-end">
                  <div class="col-md-4">
                    <div class="card bg-light">
                      <div class="card-body">
                        <div class="d-flex justify-content-between mb-2">
                          <span>Subtotal:</span>
                          <span>${{ order.totalAmount | number:'1.2-2' }}</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                          <span>Shipping:</span>
                          <span class="text-success">FREE</span>
                        </div>
                        <hr class="my-2">
                        <div class="d-flex justify-content-between">
                          <strong class="text-primary">Total Amount:</strong>
                          <strong class="text-primary h5 mb-0">${{ order.totalAmount | number:'1.2-2' }}</strong>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Invoice Footer -->
                <div class="row mt-4">
                  <div class="col-12">
                    <div class="bg-light p-3 rounded">
                      <div class="row">
                        <div class="col-md-6">
                          <small class="text-muted">
                            <strong>Payment Status:</strong> 
                            <span class="text-success">Paid</span>
                          </small>
                        </div>
                        <div class="col-md-6 text-md-end">
                          <small class="text-muted">
                            Thank you for your business!
                          </small>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>